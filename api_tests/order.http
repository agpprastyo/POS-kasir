### Order API Tests

# Configuration
@baseUrl = http://localhost:8000
# Username & Password for Login (Change if needed)
@email = admin@example.com
@password = passwordrahasia

# ==============================================================================
# 0. AUTHENTICATION (Login first to get Cookie)
# ==============================================================================

### Login to get access_token cookie
# @name login
POST {{baseUrl}}/api/v1/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

# The extensions (REST Client / Hurl / Postman) will automatically handle the Set-Cookie header.
# Subsequent requests will include the 'access_token' cookie automatically.


# ==============================================================================
# 1. CREATE ORDER
# ==============================================================================

### 1.1 Create Order Success (Dine In, with Options)
POST {{baseUrl}}/api/v1/orders
Content-Type: application/json

{
  "type": "dine_in",
  "items": [
    {
      "product_id": "5b56f439-dd13-4c3c-9997-1a24d2ee4932",
      "quantity": 2,
      "options": [
       
      ]
    }
  ]
}

### 1.2 Create Order Success (Takeaway, No Options)
POST {{baseUrl}}/orders
Content-Type: application/json

{
  "type": "takeaway",
  "items": [
    {
      "product_id": "<PRODUCT_ID_HERE>",
      "quantity": 1,
      "options": []
    }
  ]
}

### 1.3 Validation Error (Missing Items)
POST {{baseUrl}}/orders
Content-Type: application/json

{
  "type": "dine_in",
  "items": []
}

### 1.4 Validation Error (Invalid Type)
POST {{baseUrl}}/orders
Content-Type: application/json

{
  "type": "invalid_type",
  "items": [
    {
        "product_id": "<PRODUCT_ID_HERE>",
        "quantity": 1
    }
  ]
}

# ==============================================================================
# 2. PAYMENT
# ==============================================================================

### 2.1 Complete Manual Payment (Cash)
# Replace <ORDER_ID_HERE> with an ID from Create Order response
POST {{baseUrl}}/api/v1/orders/<ORDER_ID_HERE>/complete-manual-payment
Content-Type: application/json

{
  "payment_method_id": 1,
  "cash_received": 1000000
}

### 2.2 Complete Manual Payment (Static QRIS)
# Replace <ORDER_ID_HERE> with an ID from Create Order response
# Note: cash_received is optional/0, system will auto-set to NetTotal
POST {{baseUrl}}/api/v1/orders/<ORDER_ID_HERE>/complete-manual-payment
Content-Type: application/json

{
  "payment_method_id": 3
}
